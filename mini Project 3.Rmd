---
title: "Mini Project 3"
author: "Julia Lee"
date: "3/31/2018"
output: 
  html_document:
    code_folding: hide
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

library(tidyverse)
#install.packages("sf")
library(sf)
# will install version 0.3.2
# install.packages("macleish")
#devtools::install_github("beanumber/macleish")
library(macleish)
library(leaflet)
library(RSQLite)
#install.packages("lwgeom")
library(lwgeom)
```

```{r, message=FALSE, warning=FALSE}
landmarks<-macleish_layers[["landmarks"]]
trail<-macleish_layers[["trails"]]
macleish_layers[["challenge_courses"]]

macleish_layers[["forests"]] 

trails<-macleish_layers[["trails"]]%>%
  mutate(Length_Of_Trails = st_length(geometry))
names(trails)
inside_trails<-st_intersection(macleish_layers[["boundary"]],
              macleish_layers[["trails"]])
inside_streams <-st_intersection(macleish_layers[["boundary"]],
              macleish_layers[["streams"]])
streams_trails<-st_intersection(inside_trails,inside_streams)

sites <- tribble(
~point, ~lat, ~lon,
"Group Campsite", 42.450976, -72.678154,
"Remote Campite", 42.458570, -72.674732,
"Parking", 42.448013, -72.680663,)
places<-st_as_sf(sites,coords = c("lon", "lat"), crs = 4326)
#names(streams_trails)

streams<-macleish_layers[["streams"]]%>%
  mutate(Length_Of_Streams = st_length(geometry))
```

```{r, message=FALSE, warning=FALSE}
PARKING <- data.frame(lon = -72.680663 , lat = 42.448013) %>% 
  st_as_sf(coords = c("lon", "lat"), crs = 4326)
CAMP_A <- data.frame(lon = -72.68389 , lat = 42.44893) %>% 
  st_as_sf(coords = c("lon", "lat"), crs = 4326)
CAMP_B <- data.frame(lon = -72.68389 , lat = 42.44893) %>% 
  st_as_sf(coords = c("lon", "lat"), crs = 4326)
 low_point<-data.frame(lon= -72.6749333567048, lat= 42.4463482225726) %>%
  st_as_sf(coords = c("lon", "lat"), crs = 4326)
st_distance(PARKING, low_point)

```

```{r,message=FALSE, warning=FALSE}
forests<-macleish_layers[["forests"]] %>%
  rename(type_of_forest = Sheet1__Na) %>%
   mutate(Area = st_area(geometry))
research<-macleish_layers[["research"]]
color1<-colorBin("GnBu", trails$Length_Of_Trails,5, pretty = FALSE)

color2 <-colorBin("Reds", streams$Length_Of_Streams,5, pretty = FALSE)

color3<-colorFactor("Dark2", forests$type_of_forest)

```

```{r, message=FALSE, warning=FALSE }
map<-leaflet() %>%
  addTiles() %>%
  addMarkers(data = places, popup = ~point, labelOptions = labelOptions(noHide = T, direction = "bottom",
      style = list(
        "color" = "red"))) %>%
  addPolygons(data = macleish_layers[["boundary"]], 
              weight = 0.5, color = "lightyellow") %>%
  addCircles(data = macleish_layers[["challenge_courses"]], 
              weight = 1,popup = "Challenge Course", color = "green" ) %>%
  addPolylines(data = streams, weight= 3.5, popup =  ~Id, color = ~color2(Length_Of_Streams)) %>%
  addPolylines(data = trails, weight = 3, popup =  ~name, color = ~color1(Length_Of_Trails)) %>%
  addPolygons(data = macleish_layers[["wetlands"]], 
              weight = 1, fillOpacity = 0.2, popup = ~SOURCE, color = "dodgerblue") %>%
  addCircles(data = macleish_layers[["landmarks"]], 
              weight = 2, fillOpacity = 0.2, popup = ~Label, color = "orange") %>%
   addPolygons(data = forests, 
              weight = 1, fillOpacity = 0.1, color =~color3(type_of_forest), popup = ~type_of_forest)%>%
  addPolygons(data = macleish_layers[["buildings"]], weight = 1, popup = ~name) %>%
  addPolygons (data = research, popup = ~Name, weight = 1, color = "Black") %>%
  addProviderTiles("Esri.WorldTopoMap", group = "Topography") %>%
addLayersControl(baseGroups = "boundary",
overlayGroups = c("trails", "forests","buildings","streams","wetlands","challenge_courses" ), options = layersControlOptions(collapsed = FALSE))  

  
map
```








